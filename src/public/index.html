<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download App</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <div class="gif-parant">
        <img class="logogif" src="./assets/gif/logo.gif" alt="logo">
    </div>
    <div class="parent">
        <div class="parent-text">
            <img class="text" src="./assets/images/text.png" alt="logo">
        </div>
        <div class="button-parent">
            <a href="https://dingdingapk.s3.ap-south-1.amazonaws.com/build-1743072097474.apk" class="button-container">
                <img src="./assets/images/button.png" alt="Button Frame" class="button-frame">
                <span class="button-text">ANDROID</span>
            </a>
        
            <a href="https://www.dingdinghouse.com" class="button-container">
                <img src="./assets/images/button.png" alt="Button Frame" class="button-frame">
                <span class="button-text">WEB</span>
            </a>
        </div>

        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const API_BASE_URL = "https://devbackend.milkyway-casino.com/api/app/download"; // Update for production

            document.querySelectorAll(".button-container").forEach(button => {
                button.addEventListener("click", async () => {
                    const platform = button.getAttribute("data-platform");

                    try {
                        const response = await fetch(API_BASE_URL, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ platform })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }

                        const data = await response.json();
                        // Redirect user to download URL if returned by the API
                        if (data.downloadUrl) {
                            window.location.href = data.downloadUrl;
                        }
                    } catch (error) {
                        console.error("Download failed:", error);
                        alert("Download failed. Please try again.");
                    }
                });
            });
        });
    </script>
</body>
</html>
